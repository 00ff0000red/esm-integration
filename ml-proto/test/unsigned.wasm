(module
  (func $i32_trunc_u (param $x f64) (result i32)
    (return (i32.trunc_u/f64 (get_local $x)))
  )
  (func $i64_trunc_u (param $x f64) (result i64)
    (return (i64.trunc_u/f64 (get_local $x)))
  )

  (export "i32.trunc_u" $i32_trunc_u)
  (export "i64.trunc_u" $i64_trunc_u)
)

(assert_eq (invoke "i32.trunc_u" (f64.const 1e8)) (i32.const 100000000))
(assert_eq (invoke "i64.trunc_u" (f64.const 1e8)) (i64.const 100000000))

(assert_trap (invoke "i32.trunc_u" (f64.const 1e16)) "runtime: integer overflow")
(assert_eq (invoke "i64.trunc_u" (f64.const 1e16)) (i64.const 10000000000000000))

(assert_trap (invoke "i32.trunc_u" (f64.const 1e30)) "runtime: integer overflow")
(assert_trap (invoke "i64.trunc_u" (f64.const -1)) "runtime: integer overflow")

;; max_uint32
(assert_eq (invoke "i32.trunc_u" (f64.const 4294967295)) (i32.const -1))
(assert_eq (invoke "i64.trunc_u" (f64.const 4294967295)) (i64.const 4294967295))

;; max_int64+1
(assert_trap (invoke "i32.trunc_u" (f64.const 9223372036854775808)) "runtime: integer overflow")
(assert_eq (invoke "i64.trunc_u" (f64.const 9223372036854775808)) (i64.const -9223372036854775808))
